[
    {
        "@type": "Scenario",
        "configuration": null,
        "steps": {
            "Steps": [
                {
                    "name": "Create False Positive Phishing Email",
                    "type": "executePlaybook",
                    "playbookIRI": "\/api\/3\/workflows\/d896e0a9-63ea-402b-aa07-7017bde985e3",
                    "preCreateMessage": "Creating False Positive Phishing Email",
                    "postCreateMessage": "",
                    "waitTimeforNextStep": "0"
                },
                {
                    "name": "Create True Positive Phishing Email",
                    "type": "executePlaybook",
                    "playbookIRI": "\/api\/3\/workflows\/bb5c924b-28b8-41c3-b41d-9152d8a78b7d",
                    "preCreateMessage": "Creating True Positive Phishing Email",
                    "postCreateMessage": "",
                    "waitTimeforNextStep": "60"
                }
            ]
        },
        "createdAlertsID": "[\"\",\"\"]",
        "title": "Advanced Phishing Incident Management",
        "description": "# Advanced Phishing Incident Management\n\nGuided Simulation where a series of automation workflows guides your investigation via the Workspace comments. Comments tagged as *Actions* represent the tasks the analyst must do. *Hints* are simply suggestions\n\n[![Solution Pack Video](https:\/\/img.youtube.com\/vi\/eQ0G_Tgr_4M\/0.jpg)](https:\/\/www.youtube.com\/embed\/eQ0G_Tgr_4M)\n\n[Solution Pack Video Introduction](https:\/\/www.youtube.com\/embed\/eQ0G_Tgr_4M)\n\n### 1) Prerequisites\n\n**Generic Prerequisites:**\n- Incident Response Content Pack: `yum install -y fsr-ir-content-pack.x86_64`\n- SLA Connector configured (part of this solution pack)\n- File Content Extraction connector (part of this solution pack)\n- MITRE ATT\u0026CK Connector configured with scheduled ingestion\n- Solution Pack: [alt-enrichment-playbooks](https:\/\/github.com\/ftnt-cse\/solution-pack-alt-enrichment-playbooks) (Optional)\n\n**For Simulation mode (Fake mock data):**\n- Make sure your global variable: `Demo_mode` is set to `true` (Playbook editors \u003E Tools \u003E Global Variables)\n- FortiSOAR SOC Simulator Connector configured (1.0.9+)\n- FortiGuard Connector configured\n- VirusTotal Connector configured\n\n**For Live mode (Real data):**\n- MS Exchange\/SMTP Connectors configured with your MS Exchange parameters (To send notifications and run remediation actions)\n- AD Connector configured with your DC parameters (For users enrichment)\n- AlienVaultOTX Connector configured (Optional CTI)\n- IPstack Connector configured (Optional CTI)\n- APIVoid Connector configured (Optional CTI)\n- MXToolBox (Optional CTI)\n- HybridAnalysis (Optional CTI)\n\n### 2) Configuration:\n#### Global Variables:\nYou need to set the below global variables in the playbook editor (**Automation \u003E playbooks \u003E (open any playbook) \u003E Tools \u003E Global Variables**)\n- **Demo_mode:** if set to **true** the playbooks will use mock data instead of getting it via the connectors\n- **Default_Email:** used as email sender\n\n### 3) Installation\/Deployment:\n- Download the repo\u0027s zip from this page, click on: **Code \u003E Download ZIP** and save the ZIP file to your workstation\n- Open FortiSOAR import wizard located at: **Settings \u003E Import Wizard**. Click on ![Import From File](import_from_file.png)\n- Drag and drop the zip file you downloaded and follow the wizard\n\n### 4) Simulation Steps:\n- False Positive Alert: **Immediate action required**\n  - The email is parsed, you will have to set the status to **Investigating** so the acknowledgment SLA will be computed\n  - Inspect the various parsed email field such as Body and Headers \n  - Run Investigation Playbook \u003C Phishing Alert Enrichment and Investigation \u003E\n  - Notice The Alert Description, the email is tagged \u003CInternal\u003E\n  - No malicious indicators found\n  - The alert is closed as a false positive with a closure note: *Alert closed as False Positive, No Malicious component found*\n\n- True Positive Alert: **Fw: Vulnerability Patching Instructions**\n  - The email is parsed, you will have to set the status to **Investigating** so the acknowledgment SLA will be computed\n  - Inspect the various parsed email field such as Body and Headers \n  - Run Investigation Playbook **Phishing Alert Enrichment and Investigation**\n  - Open the Playbook logs and follow the execution of the above playbook\n  - Email Indicators are extracted and rated, notice the several of them with bad reputation\n  - The executed playbook will escalate the alert automatically due to the malicious indicators. The alert will be closed for the remaining case investigation will be carried out as an incident by a T2 analyst\n  - Browse to **Correlations \u003E Incidents** and open the newly escalated incident\n  - As T2 Analyst start the Incident Management by setting the Incident Status to : **In Progress** and its Phase status to : **Confirmation**\n  - Browse to Indicators Tab and review the malicious Indicators, there are few of them\n  - Expand the Incident description and notice the email origin, check if any of the targeted users is a high profile one. Users Active Directory details can be found at **Correlations \u003E  Users**\n  - Open the file Attachment indicator which looks like: **Password_Update_Guide_XXXX.docx** and run the playbook: **Extract and Process Text From File** \n  - Notice there no reputation is found for the file (0 day?), so it\u0027s risk factor has to be determined manually. Identify the indicator risk, if high set the Reputation to **Malicious**\n  - If the case is confirmed True Positive browse to Incident module, set the Phase to **Eradication** and use the Execute button to run the remediation Playbook **Phishing Incident Response**\n  - Notice how the email sender is blocked on the email gateway and the phishing email is deleted from all recipients mailboxes.\n\n\n\n### 5) Known issues (7.0.2)\n- Fix Playbook: Case management \/ Alert \u003E [05] Update Ack and Response Due dates (Post Severity Change)\n- Open the step: **Update Reset Resp SLA Condition** and replace its content with:\n```(vars.input.records[0].respSlaStatus.itemValue == (\u0022SLAState\u0022 | picklist(\u0022Awaiting Action\u0022, \u0022itemValue\u0022)) and \u0027Closed\u0027 not in vars.input.records[0].status.itemValue) or vars.input.records[0].respSlaStatus.itemValue == (\u0022SLAState\u0022 | picklist(\u0022NA\u0022, \u0022itemValue\u0022)) and (vars.input.records[0].status.itemValue != vars.sla_time_list.alertResTrackedOn)```",
        "comments": [
            "\/api\/3\/comments\/0bf3714a-8604-46a1-ab91-70589ee1427c",
            "\/api\/3\/comments\/52e4d3a6-0d79-4346-9e8d-360496819f9f"
        ],
        "uuid": "11b4d0a0-0bbf-427e-aee9-2008c4f92422",
        "createUser": "\/api\/3\/people\/3451141c-bac6-467c-8d72-85e0fab569ce",
        "createDate": 1643603315,
        "modifyUser": "\/api\/3\/appliances\/57545210-2adc-472b-a24f-2df6ee8dfe63",
        "modifyDate": 1644680612,
        "id": 22,
        "recordTags": [
            "FortiSOAR",
            "Phishing"
        ]
    }
]